(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{274:function(t,a,s){t.exports=s.p+"assets/img/pwa_install_menu.41073796.jpg"},275:function(t,a,s){t.exports=s.p+"assets/img/pwa_install.cc0b35b6.jpg"},276:function(t,a,s){t.exports=s.p+"assets/img/splash-screen.a247c4ec.jpg"},277:function(t,a,s){t.exports=s.p+"assets/img/pwa-fullscreen.20336af1.jpg"},278:function(t,a,s){t.exports=s.p+"assets/img/pwa_setup_button.1a13ee70.png"},279:function(t,a,s){t.exports=s.p+"assets/img/pwa_setup_prompt.4b3c7ae2.png"},280:function(t,a,s){t.exports=s.p+"assets/img/pwa_installed.7df4c154.png"},349:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"step-5-installing-the-pwa-on-the-device"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-5-installing-the-pwa-on-the-device"}},[t._v("#")]),t._v(" Step 5 : Installing the PWA on the device")]),t._v(" "),a("h2",{attrs:{id:"criteria-for-being-installable"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#criteria-for-being-installable"}},[t._v("#")]),t._v(" Criteria for being installable")]),t._v(" "),a("p",[t._v("One of the advantages of PWA is that they can be installed if they respect certain criteria which depend on the browser. Here are the criteria for "),a("a",{attrs:{href:"https://developers.google.com/web/fundamentals/app-install-banners/#criteria",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chrome"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("ul",[a("li",[t._v("The web app is not already installed.\n"),a("ul",[a("li",[t._v("and "),a("code",[t._v("prefer_related_applications")]),t._v(" is not true.")])])]),t._v(" "),a("li",[t._v("Meets a user engagement heuristic (currently, the user has interacted with the domain for at least 30 seconds)")]),t._v(" "),a("li",[t._v("Includes a web app manifest that includes:\n"),a("ul",[a("li",[a("code",[t._v("short_name")]),t._v(" or "),a("code",[t._v("name")])]),t._v(" "),a("li",[t._v("icons must include a 192px and a 512px sized icons")]),t._v(" "),a("li",[a("code",[t._v("start_url")])]),t._v(" "),a("li",[t._v("display must be one of: "),a("code",[t._v("fullscreen")]),t._v(", "),a("code",[t._v("standalone")]),t._v(", or "),a("code",[t._v("minimal-ui")])])])]),t._v(" "),a("li",[t._v("Served over HTTPS (required for service workers)")]),t._v(" "),a("li",[t._v("Has registered a service worker with a fetch event handler")])]),t._v(" "),a("h2",{attrs:{id:"installing-the-pwa"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installing-the-pwa"}},[t._v("#")]),t._v(" Installing the PWA")]),t._v(" "),a("p",[t._v("Depending on the browser and OS, the technical requirements to install the PWA on the system may vary. But in theory, if you have a manifest and an active Service Worker handling incoming requests with "),a("code",[t._v("fetch")]),t._v(", then you should be able to install that PWA on all supported platforms, and they will leverage the manifest and Service Worker.")]),t._v(" "),a("p",[t._v("The platform with the best support today is "),a("strong",[t._v("Android")]),t._v(". If you have an Android smartphone that can connect to your server by sharing a local connection, then try to load the app through Chrome for Android. Once the web page is open, the Chrome menu should include the option: "),a("strong",[t._v("Add to home screen")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(274),alt:"Add to home screen"}})]),t._v(" "),a("p",[t._v("Continue the installation. A new shortcut should appear in your phone home screen. This is the shortcut to our PWA!")]),t._v(" "),a("p",[a("img",{attrs:{src:s(275),alt:"PWA bookmark"}}),t._v(" "),a("img",{attrs:{src:s(276),alt:"Splash-screen"}})]),t._v(" "),a("p",[t._v("Once the PWA is installed, when you click on the shortcut, a splash screen is displayed briefly. It uses the colors and icons specified in the web app manifest.")]),t._v(" "),a("p",[t._v("You will also notice that the URL bar and the rest of the browser UI are no longer shown if you have set the "),a("code",[t._v("display")]),t._v(" property to "),a("code",[t._v("standalone")]),t._v(" in the manifest.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(277),alt:"PWA run from bookmark"}})]),t._v(" "),a("h2",{attrs:{id:"add-an-installation-button"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#add-an-installation-button"}},[t._v("#")]),t._v(" Add an installation button")]),t._v(" "),a("p",[t._v("Originally, the browser handled all the steps related to installation from the presentation of the banner to the addition of the app icon to the homescreen. However, it is now possible for the app to handle the presentation of the UI that leads to the PWA install prompt. In this case, the browser manages whether we should display that button and the presentation of the prompt. The app should verify if it can show an install prompt by listening to a "),a("code",[t._v("beforeinstallprompt")]),t._v(" event and ask the browser to show the install prompt if the user requests it.")]),t._v(" "),a("p",[t._v("Let's add our own "),a("strong",[t._v("install prompt button")]),t._v(" to our PWA by following these steps:")]),t._v(" "),a("ol",[a("li",[t._v("Set the property "),a("a",{attrs:{href:"https://developers.google.com/web/fundamentals/app-install-banners/native#prefer_related_applications",target:"_blank",rel:"noopener noreferrer"}},[t._v("prefer_related_applications"),a("OutboundLink")],1),t._v(" to "),a("code",[t._v("false")]),t._v(" in the manifest file.")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prefer_related_applications"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Add a button tag somewhere in your page, hidden by default:")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("install_button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("hidden")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Install"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("In the main JavaScript file, intercept the "),a("code",[t._v("beforeinstallprompt")]),t._v(" event which is fired when the PWA meets to install criteria. In this event event handler, we need to keep a reference to the event and show the install button.")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" deferredPrompt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allows to show the install prompt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" installButton "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"install_button"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beforeinstallprompt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beforeinstallprompt fired"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Prevent Chrome 76 and earlier from automatically showing a prompt")]),t._v("\n  e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Stash the event so it can be triggered later.")]),t._v("\n  deferredPrompt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Show the install button")]),t._v("\n  installButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hidden "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  installButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"click"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" installApp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Then add an "),a("code",[t._v("installApp")]),t._v(" function that shows the install prompt:")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("installApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Show the prompt")]),t._v("\n  deferredPrompt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("prompt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  installButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("disabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Wait for the user to respond to the prompt")]),t._v("\n  deferredPrompt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userChoice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("choiceResult")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("choiceResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("outcome "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accepted"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PWA setup accepted"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      installButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hidden "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PWA setup rejected"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    installButton"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("disabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    deferredPrompt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("Optionally, we can listen for the app installed event to perform any additional setup when the install finished")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"appinstalled"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("evt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"appinstalled fired"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" evt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Experimental")]),t._v(" "),a("p",[a("code",[t._v("beforeinstallprompt")]),t._v(" and "),a("code",[t._v("appinstalled")]),t._v(" events are experimental and not yet standardized. On January 2020, they were only supported on Chrome, Chrome for Android and Samsung Internet.")])]),t._v(" "),a("p",[t._v("Now is the time to test. Don't hesitate to fully reload the page after clearing the cache.")]),t._v(" "),a("p",[a("img",{attrs:{src:s(278),alt:"PWA install button"}}),t._v(" "),a("img",{attrs:{src:s(279),alt:"PWA install prompt"}})]),t._v(" "),a("p",[t._v("Here is how an installed PWA looks on macOS")]),t._v(" "),a("p",[a("img",{attrs:{src:s(280),alt:"PWA installed"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);